/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e=new function(){var r,a,l,d=[],m=[],u=[],c=0;function f(e,t,n,i){this.name=e,this.emailAddress=t,this.routiingType=n,this.mailboxType=i}function h(){if(0==d.length||c>100)r(u);else{var t=d.pop();m.push(t),e.expandGroup(t,(function(e){for(var t=0;t<e.length;t++){var n=e[t];if("PublicDL"==n.MailboxType()||"PrivateDL"==n.MailboxType())m.indexOf(n.Address())<0&&d.indexOf(n.Address())<0&&(c++,d.push(n.Address()));else{for(var i=!1,s=0;s<u.length;s++)if(u[s].Address()==n.Address()){i=!0;break}0==i&&u.push(n)}}h()}),(function(e){a(e)}),(function(e){l(e)}))}}function p(e){return'<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"               xmlns:xsd="http://www.w3.org/2001/XMLSchema"               xmlns:m="http://schemas.microsoft.com/exchange/services/2006/messages"               xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"               xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types">   <soap:Header>       <RequestServerVersion Version="Exchange2013" xmlns="http://schemas.microsoft.com/exchange/services/2006/types" soap:mustUnderstand="0" />   </soap:Header>   <soap:Body>'+e+"</soap:Body></soap:Envelope>"}function I(e,t,n,i){Office.context.mailbox.makeEwsRequestAsync(e,(function(s){if("succeeded"==s.status){var o=(new DOMParser).parseFromString(s.value,"text/xml");t(o),i("STATUS: "+s.status+"\n---- START SOAP ----\n"+e+"\n---- END SOAP ----\n---- START RESPONSE ----\n"+s.value+"---- END RESPONSE ----")}else null!=n&&(n(s.error),i("STATUS: "+s.status+"\nERROR: "+s.error+"\n---- START SOAP ----\n"+e+"\n---- END SOAP ----\n---- START RESPONSE ----\n"+s.value+"---- END RESPONSE ----"))}))}function g(e,t){var n=t.substring(t.indexOf(":")+1),i=e.getElementsByTagName(t);return null!=i&&0!=i.length||(i=e.getElementsByTagName(n)),i}this.getParentId=function(e,t,n,i){var s='<m:GetItem>    <m:ItemShape>        <t:BaseShape>AllProperties</t:BaseShape>    </m:ItemShape>    <m:ItemIds>        <t:ItemId Id="'+e+'"/>    </m:ItemIds></m:GetItem>';I(s=p(s),(function(e){var o="";try{o=g(e,"t:InReplyTo")[0].textContent}catch(e){return void t(null)}o=o.replace("<","&lt;").replace(">","&gt;"),I(s=p(s='<m:FindItem Traversal="Shallow">\t<m:ItemShape>\t\t<t:BaseShape>IdOnly</t:BaseShape>\t</m:ItemShape>\t<m:IndexedPageItemView MaxEntriesReturned="50" Offset="0" BasePoint="Beginning" />\t<m:Restriction>\t\t<t:Contains ContainmentMode="Substring" ContainmentComparison="IgnoreCase">\t\t\t<t:FieldURI FieldURI="message:InternetMessageId" />\t\t\t<t:Constant Value="'+o+'" />\t\t</t:Contains>\t</m:Restriction>\t<m:ParentFolderIds>\t\t<t:DistinguishedFolderId Id="inbox" />\t</m:ParentFolderIds></m:FindItem>'),(function(e){var n=g(e,"t:ItemId")[0].attributes.Id.value;t&&t(n)}),(function(e){n&&n(e)}),(function(e){i&&i(e)}))}),(function(e){n&&n(e)}),(function(e){i&&i(e)}))},this.resolveRecipient=function(e,t,n,i){var s='<ResolveNames xmlns="http://schemas.microsoft.com/exchange/services/2006/messages" xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types" ReturnFullContactData="true"><UnresolvedEntry>'+e+"</UnresolvedEntry></ResolveNames>";I(s=p(s),(function(e){if(t){var n=g(e,"m:MessageText");if(null!=n&&n.length>0&&"No results were found."==n[0].innerHTML)t(null);else{for(var i=[],s=g(e,"t:Mailbox"),o=0;o<s.length;o++){var r=s[o],a=new f(g(r,"t:Name")[0].textContent,g(r,"t:EmailAddress")[0].textContent,g(r,"t:RoutingType")[0].textContent,g(r,"t:MailboxType")[0].textContent);i.push(a)}t(i)}}}),(function(e){null!=n&&n(e)}),(function(e){null!=i&&i(e)}))},this.sendMailItem=function(e){var n,i=e.subject,s="html"==e.bodytype.toLowerCase()?"HTML":"Text",o="HTML"==s?(n=function(e){return{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;"}[e]||e},e.body.replace(/[&<>"]/g,n)):e.body,r=void 0!==e.recipients&&null!==e.recipients?e.recipients:[],a=void 0!==e.attachments&&null!==e.attachments?e.attachments:[new t("","")],l=void 0!==e.folderid&&null!==e.folderid&&""!==e.folderid?e.folderid:"sentitems",d=e.successCallback,m=e.errorCallback,u=e.debugCallback,c="";if(null!=r&&0!=r.length){if(r.forEach((function(e){c+="<t:Mailbox><t:EmailAddress>"+e+"</t:EmailAddress></t:Mailbox>"})),c="<t:ToRecipients>"+c+"</t:ToRecipients>",null!=a&&a.length>0){var f="";a.forEach((function(e){""!==e.name&&""!==e.mime&&("item"==e.type?f+="<t:ItemAttachment><t:Name>"+e.name+'</t:Name><t:IsInline>false</t:IsInline><t:Message><t:MimeContent CharacterSet="UTF-8">'+e.mime+"</t:MimeContent></t:Message></t:ItemAttachment>":f+="<t:FileAttachment><t:Name>"+e.name+"</t:Name><t:IsInline>false</t:IsInline><t:IsContactPhoto>false</t:IsContactPhoto><t:Content>"+e.mime+"</t:Content></t:FileAttachment>")})),""!==f&&(f="<t:Attachments>"+f+"</t:Attachments>")}var h='<m:CreateItem MessageDisposition="SendAndSaveCopy"><m:SavedItemFolderId><t:DistinguishedFolderId Id="'+l+'" /></m:SavedItemFolderId>    <m:Items>        <t:Message>            <t:Subject>'+i+'</t:Subject>            <t:Body BodyType="'+s+'">'+o+"</t:Body>"+f+c+"        </t:Message>    </m:Items></m:CreateItem>";I(h=p(h),(function(e){var t=e.getElementsByTagName("m:ResponseCode")[0];null==t&&(t=e.getElementsByTagName("ResponseCode")[0]);var n=t.textContent;"NoError"==n?d(n):null!=m&&m(n)}),(function(e){null!=m&&m(e)}),(function(e){null!=u&&u(e)}))}else m("No recipients defined.")},this.sendPlainTextEmailWithAttachment=function(e,i,s,o,r,a,l,d){var m=new n(e,i,"text",[s],[new t(o,r,"item")],"sentitems",a,l,d);this.sendMailItem(m)},this.getMailItemMimeContent=function(e,t,n,i){var s='<m:GetItem>    <m:ItemShape>        <t:BaseShape>IdOnly</t:BaseShape>        <t:IncludeMimeContent>true</t:IncludeMimeContent>    </m:ItemShape>    <m:ItemIds>        <t:ItemId Id="'+e+'"/>    </m:ItemIds></m:GetItem>';I(s=p(s),(function(e){var n=g(e,"t:MimeContent")[0].textContent;t(n)}),(function(e){null!=n&&n(e)}),(function(e){null!=i&&i(e)}))},this.updateEwsHeader=function(e,t,n,i,s,o,r){var a='<m:UpdateItem MessageDisposition="SaveOnly" ConflictResolution="AlwaysOverwrite">';i&&(a='<m:UpdateItem MessageDisposition="SaveOnly" ConflictResolution="AlwaysOverwrite" SendMeetingInvitationsOrCancellations="SendOnlyToChanged">');var l=a+'   <m:ItemChanges>       <t:ItemChange>           <t:ItemId Id="'+e+'"/>           <t:Updates>               <t:SetItemField>                   <t:ExtendedFieldURI DistinguishedPropertySetId="InternetHeaders"                                       PropertyName="'+t+'"                                       PropertyType="String" />                   <t:Message>                       <t:ExtendedProperty>                           <t:ExtendedFieldURI DistinguishedPropertySetId="InternetHeaders"                                               PropertyName="'+t+'"                                               PropertyType="String" />                               <t:Value>'+n+"</t:Value>                           </t:ExtendedProperty>                   </t:Message>               </t:SetItemField>           </t:Updates>       </t:ItemChange>   </m:ItemChanges></m:UpdateItem>";I(l=p(l),(function(e){s&&s("succeeded")}),(function(e){null!=o&&o(e)}),(function(e){null!=r&&r(e)}))},this.getFolderItemIds=function(e,t,n,i,s){null===s&&(s={maxEntries:10,queryString:""});var o='<m:FindItem Traversal="Shallow">   <m:ItemShape>        <t:BaseShape>IdOnly</t:BaseShape>   </m:ItemShape>   <m:ParentFolderIds>       <t:FolderId Id="'+e+'"/>   </m:ParentFolderIds>   <m:IndexedPageItemView MaxEntriesReturned="'+(s.maxEntries?s.maxEntries:10)+'" Offset="0" BasePoint="Beginning" />   <m:QueryString>'+(s.queryString?s.queryString:"")+"</m:QueryString></m:FindItem>",r=[];I(o=p(o),(function(e){for(var n=g(e,"t:ItemId"),i=0;i<n.length;i++)r.push(n[i].getAttribute("Id"));t(r)}),(function(e){null!=n&&n(e)}),(function(e){null!=i&&i(e)}))},this.getMailItem=function(e,t,n,s){var o='<m:GetItem>   <m:ItemShape>       <t:BaseShape>Default</t:BaseShape>       <t:IncludeMimeContent>true</t:IncludeMimeContent>   </m:ItemShape>   <m:ItemIds>       <t:ItemId Id="'+e+'" />   </m:ItemIds></m:GetItem>';I(o=p(o),(function(e){var n=new i(e);t(n)}),(function(e){null!=n&&n(e)}),(function(e){null!=s&&s(e)}))},this.splitGroupsAsync=function(e,t,n,i){u=[],m=[],c=0,(d=[]).push(e),r=t,a=n,l=i,h()},this.expandGroup=function(e,t,n,i){var o="<m:ExpandDL>    <m:Mailbox>        <t:EmailAddress>"+e.replace("&amp;","&").replace("&","&amp;")+"</t:EmailAddress>    </m:Mailbox></m:ExpandDL>";o=p(o);var r=[];I(o,(function(e){for(var n=g(e,"t:Mailbox"),i=0;i<n.length;i++)r.push(new s(n[i]));t(r)}),(function(e){null!=n&&n(e)}),(function(e){null!=i&&i(e)}))},this.findConversationItems=function(e,t,n,i){var s='       <m:GetConversationItems>           <m:ItemShape>               <t:BaseShape>IdOnly</t:BaseShape>               <t:AdditionalProperties>                   <t:FieldURI FieldURI="item:Subject" />                   <t:FieldURI FieldURI="item:DateTimeReceived" />               </t:AdditionalProperties>           </m:ItemShape>           <m:FoldersToIgnore>               <t:DistinguishedFolderId Id="deleteditems" />               <t:DistinguishedFolderId Id="drafts" />           </m:FoldersToIgnore>           <m:SortOrder>TreeOrderDescending</m:SortOrder>           <m:Conversations>               <t:Conversation>                   <t:ConversationId Id="'+e+'" />               </t:Conversation>           </m:Conversations>       </m:GetConversationItems>';I(s=p(s),(function(e){var i=[];try{var s=g(e,"t:ItemId");if(null==s)null!=n&&n(new Error("The XML returned from the server could not be parsed."));else if(0==s.length)t(null);else{for(var o=0;o<s.length;o++)i.push(s[o].getAttribute("Id"));t(i)}}catch(e){null!=n&&n(e)}}),(function(e){null!=n&&n(e)}),(function(e){null!=i&&i(e)}))},this.getSpecificHeader=function(e,t,n,i,s,o){var r='   <m:GetItem>       <m:ItemShape>           <t:BaseShape>IdOnly</t:BaseShape>           <t:AdditionalProperties>               <t:ExtendedFieldURI DistinguishedPropertySetId="InternetHeaders" PropertyName="'+t+'" PropertyType="'+n+'" />           </t:AdditionalProperties>       </m:ItemShape>       <m:ItemIds>           <t:ItemId Id="'+e+'" />       </m:ItemIds>   </m:GetItem>';r=p(r);var a="";I(r,(function(e){try{if(null==e)return void i(null);for(var n=g(e,"t:ExtendedProperty"),o=0;o<n.length;o++){var r=n[o],l=g(r,"t:ExtendedFieldURI")[0].getAttribute("PropertyName"),d=g(r,"t:Value")[0].textContent;l==t&&(a=d)}i(a)}catch(e){null!=s&&s(e)}}),(function(e){null!=s&&s(e)}),(function(e){null!=o&&o(e)}))},this.getEwsHeaders=function(e,t,n,i){var s='   <m:GetItem>       <m:ItemShape>           <t:BaseShape>AllProperties</t:BaseShape>           <t:IncludeMimeContent>true</t:IncludeMimeContent>       </m:ItemShape>       <m:ItemIds>           <t:ItemId Id="'+e+'" />       </m:ItemIds>   </m:GetItem>';s=p(s);var r=new o;I(s,(function(e){try{if(null==e)return void t(null);var i=g(e,"t:InternetMessageHeader");if(null!==i&&null!=i){for(var s=0;s<i.length;s++)r.add(i[s].getAttribute("HeaderName"),i[s].textContent);t(r)}else t(null)}catch(e){null!=n&&n(e)}}),(function(e){null!=n&&n(e)}),(function(e){null!=i&&i(e)}))},this.updateFolderProperty=function(e,t,n,i,s,o){var r='       <m:UpdateFolder>           <m:FolderChanges>               <t:FolderChange>                   <t:FolderId Id="'+e+'" />                   <t:Updates>                       <t:SetFolderField>                           <t:ExtendedFieldURI                               DistinguishedPropertySetId="PublicStrings"                               PropertyName="'+t+'"                               PropertyType="String" />                            <t:Folder>                               <t:ExtendedProperty>                                  <t:ExtendedFieldURI                                      DistinguishedPropertySetId="PublicStrings"                                      PropertyName="'+t+'"                                      PropertyType="String" />                                 <t:Value>'+n+"</t:Value>                              </t:ExtendedProperty>                           </t:Folder>                       </t:SetFolderField>                   </t:Updates>               </t:FolderChange>           </m:FolderChanges>       </m:UpdateFolder>";I(r=p(r),(function(e){null!=i&&i("succeeeded")}),(function(e){null!=s&&s(e)}),(function(e){null!=o&&o(e)}))},this.getFolderProperty=function(e,t,n,i,s){var o='<m:GetFolder><m:FolderShape><t:BaseShape>IdOnly</t:BaseShape><t:AdditionalProperties><t:ExtendedFieldURI    DistinguishedPropertySetId="PublicStrings"    PropertyName="'+t+'"    PropertyType="String" /></t:AdditionalProperties></m:FolderShape><m:FolderIds><t:FolderId Id="'+e+'"/></m:FolderIds></m:GetFolder>';I(o=p(o),(function(e){var t=g(e,"t:Value");t.length>0?n(t[0].textContent):n(null)}),(function(e){null!=i&&i(e)}),(function(e){null!=s&&s(e)}))},this.getFolderId=function(e,t,n,i){var s='    <m:GetFolder>      <m:FolderShape>        <t:BaseShape>IdOnly</t:BaseShape>      </m:FolderShape>      <m:FolderIds>        <t:DistinguishedFolderId Id="'+e+'" />      </m:FolderIds>    </m:GetFolder>';I(s=p(s),(function(e){var i=g(e,"t:FolderId");if(i.length>0){var s=i[0].getAttribute("Id");t(s)}else n("Unable to get folder ID")}),(function(e){null!=n&&n(e)}),(function(e){null!=i&&i(e)}))},this.moveItem=function(e,t,n,i,s){var o='<MoveItem xmlns="http://schemas.microsoft.com/exchange/services/2006/messages"          xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types">    <ToFolderId>        <t:DistinguishedFolderId Id="'+t+'"/>    </ToFolderId>    <ItemIds>        <t:ItemId Id="'+e+'"/>    </ItemIds></MoveItem>';I(o=p(o),(function(e){null!=n&&n("succeeeded")}),(function(e){null!=i&&i(e)}),(function(e){null!=s&&s(e)}))},this.getAllRecipientsAsync=function(e,t,n){var i=[],s=[];e.to.getAsync((function(o){if(o.error)n(error);else{var r=o.value;r.length>0&&r.forEach((function(e,t){if(e.recipientType==Office.MailboxEnums.RecipientType.DistributionList){for(var n=!1,o=0;o<s.length;o++)if(s[o].emailAddress==e.emailAddress){n=!0;break}n||s.push(e)}else{for(n=!1,o=0;o<i.length;o++)if(i[o].emailAddress==e.emailAddress){n=!0;break}n||i.push(e)}})),e.cc.getAsync((function(o){if(o.error)n(error);else{var r=o.value;r.length>0&&r.forEach((function(e,t){if(e.recipientType==Office.MailboxEnums.RecipientType.DistributionList){for(var n=!1,o=0;o<s.length;o++)if(s[o].emailAddress==e.emailAddress){n=!0;break}n||s.push(e)}else{for(n=!1,o=0;o<i.length;o++)if(i[o].emailAddress==e.emailAddress){n=!0;break}n||i.push(e)}})),e.bcc.getAsync((function(e){if(e.error)n(error);else{var o=e.value;o.length>0?(o.forEach((function(e,t){if(e.recipientType==Office.MailboxEnums.RecipientType.DistributionList){for(var n=!1,o=0;o<s.length;o++)if(s[o].emailAddress==e.emailAddress){n=!0;break}n||s.push(e)}else{for(n=!1,o=0;o<i.length;o++)if(i[o].emailAddress==e.emailAddress){n=!0;break}n||i.push(e)}})),t(i,s)):t(i,s)}}))}}))}}))}};function t(e,t,n){this.name=e||"",this.mime=t||"",this.type=n||""}function n(e,n,i,s,o,r,a,l,d){this.subject=e||"",this.body=n||"",this.bodytype=i||"text",this.recipients=null!=s?s:[""],this.attachments=null!=o?o:[new t("","")],this.folderid=null!=r&&""!==r?r:"sentitems",this.successCallback=a||{},this.errorCallback=l||{},this.debugCallback=d||{}}function i(e){this.value=e||{},this.MimeContent=function(){return this.value.getElementsByTagName("t:MimeContent")[0].textContent},this.CharacterSet=function(){return this.value.getElementsByTagName("t:MimeContent")[0].getAttribute("CharacterSet")},this.Subject=function(){return this.value.getElementsByTagName("t:Subject")[0].textContent},this.Body=function(){return this.value.getElementsByTagName("t:Body")[0].textContent}}function s(e){this.value=e||{},this.Name=function(){return this.value.getElementsByTagName("t:Name")[0].textContent},this.Address=function(){return this.value.getElementsByTagName("t:EmailAddress")[0].textContent},this.RoutingType=function(){return this.value.getElementsByTagName("t:RoutingType")[0].textContent},this.MailboxType=function(){return this.value.getElementsByTagName("t:MailboxType")[0].textContent}}function o(e){this.values=e||{};var t=function(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])};this.containsKey=function(e){return Object.prototype.hasOwnProperty.call(this.values,e)&&Object.prototype.propertyIsEnumerable.call(this.values,e)},this.forEach=function(e){t(this.values,e)},this.lookup=function(e){return this.values[e]},this.add=function(e,t){this.values[e]=t},this.length=function(){var e=0;return t(this.values,(function(){e++})),e}}function r(e,t,n,i,s,o,r){try{var a=e[o](r),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(i,s)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(i,s){var o=e.apply(t,n);function a(e){r(o,i,s,a,l,"next",e)}function l(e){r(o,i,s,a,l,"throw",e)}a(void 0)}))}}var l="no suspicious activity has been detected",d=/\{\%\%(.+)\%\%\}/,m=!1,u=!1,c=0,f=[];function h(e){var t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""}function p(e){I();var t=document.getElementById("messageBanner");t.querySelector(".ms-MessageBanner-clipper").innerHTML="Something went wrong: "+JSON.stringify(e),t.style.display="none",console.log(e)}function I(){document.getElementById("app-body").style.display="",document.getElementById("spinner").style.display="none"}function g(){"none"===document.getElementById("spinner").style.display?(document.getElementById("app-body").style.display="none",document.getElementById("spinner").style.display=""):I()}function y(){var t=Office.context.mailbox.item.itemId;e.getMailItemMimeContent(t,(function(n){e.sendPlainTextEmailWithAttachment("Suspicious Email Alert","{%%"+t+"%%}","bad@mail.com","Suspicious_Email.msg",n,(function(e){console.log(e)}),(function(e){return p(e)}),(function(e){}))}),(function(e){return p(e)}),(function(e){}))}function v(t){e.moveItem(t,"deleteditems",(function(e){}),(function(e){return p(e)}),(function(e){}))}function S(e,t){g(),console.debug("Found result!");var n=t.Body(),i="CheckMark";2==(c=n.search(l)<=0?2:1)&&(i="AlertSolid"),t='<li class="ms-ListItem">  <i class="ms-Icon ms-Icon--'+i+' ms-font-xl"></i>  <span class="ms-font-m">    <u>'+h(t.Subject())+"</u>    was marked as harmless.  </span></li>",document.getElementById("results").innerHTML=document.getElementById("results").innerHTML+t,document.getElementById("welcome-features").style.display="none",document.getElementById("results").style.display="",v(e)}function x(t,n,i){e.getFolderId(t,(function(t){e.getFolderItemIds(t,(function(t){t.forEach((function(n,s){e.getMailItem(n,(function(e){return i(n,e,s,t.length-1)}),(function(e){return p(e)}),(function(e){}))}))}),(function(e){return p(e)}),(function(e){}),{maxEntries:10,queryString:n})}),(function(e){return p(e)}),(function(e){}))}function E(){setTimeout((function(){console.debug("Searching for results.."),x("inbox",'from:"bad@mail.com" AND received:today',S),m||1===c||2===c||E()}),1e4),u||(setTimeout((function(){1!==c&&2!==c&&(console.debug("Timeout!"),m=!0,g())}),36e4),u=!0)}function b(){g(),f=[],x("inbox",'from:"bad@mail.com" AND received:today',(function(e){return v(e)})),x("sentitems",'to:"bad@mail.com" AND received:today',(function(t,n,i,s){var o=n.Body().match(d);o&&o.length>0&&f.push({id:o[1],result:0}),i>=s&&x("deleteditems",'from:"bad@mail.com" AND received:today',(function(t,n,i,s){var o=n.Body(),r=o.match(d);r&&r.length>0&&f.forEach((function(e,t){e.id===r[1]&&(o.search(l)<=0?f[t].result=2:f[t].result=1)})),i>=s&&(function(t){document.getElementById("results").innerHTML="",t.forEach((function(n,i){e.getMailItem(n.id,(function(e){var t="CheckMark";2==n.result&&(t="AlertSolid");var i='<li class="ms-ListItem">  <i class="ms-Icon ms-Icon--'+t+' ms-font-xl"></i>  <span class="ms-font-m">    <u>'+h(e.Subject())+"</u>    was marked as harmless.  </span></li>";document.getElementById("results").innerHTML=document.getElementById("results").innerHTML+i}),(function(e){return p(e)}),(function(e){})),i>=t.length-1&&(document.getElementById("welcome-features").style.display="none",document.getElementById("results").style.display="")}))}(f),g())}))}))}function T(){return C.apply(this,arguments)}function C(){return(C=a(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:g(),c=0,y(),E();case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Office.onReady((function(e){if(e.host===Office.HostType.Outlook){document.getElementById("mail-subject").innerHTML=h(Office.context.mailbox.item.subject),document.getElementById("app-body").style.display="flex",document.getElementById("run").onclick=T,document.getElementById("update").onclick=b;for(var t=document.querySelectorAll(".ms-Spinner"),n=0;n<t.length;n++)new fabric.Spinner(t[n]);var i=document.getElementById("messageBanner");i.querySelector(".ms-MessageBanner-close").addEventListener("click",(function(){setTimeout((function(){i.style.display="none"}),500)})),x("inbox",'from:"bad@mail.com" AND received:today',(function(e){return v(e)}))}}))}();
//# sourceMappingURL=taskpane.js.map